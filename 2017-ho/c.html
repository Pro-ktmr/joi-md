<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>
<p>JOIOI 王国は <var>H</var> 行 <var>W</var> 列のマスに区切られた長方形の形をしている．JOIOI 王国では，行政の効率化のため，国全体を <var>2</var> つの地域 JOI と IOI に分けることにした．</p>
<p>地域の分け方が複雑になりすぎるのを防ぐため，以下の条件を満たすように分割を行うことにした：</p>
<ul>
<li>各地域は，<var>1</var> つ以上のマスを含む．</li>
<li>それぞれのマスは，<var>2</var> つの地域のうちのちょうど <var>1</var> つに属する．</li>
<li>地域 JOI に属するどの <var>2</var> つのマスの間も，その地域に属さないマスに入らずに辺で接しているマスへの移動を繰り返すことにより移動できる．地域 IOI についても同様である．</li>
<li>各行，各列について，その行または列に属するマス全体を取り出したとき，それぞれの地域のマスはひとつながりになっている．ただし，その行あるいは列のすべてのマスが同じ地域に属していてもよい．</li>
</ul>
<p>各マスには標高と呼ばれる整数が定まっている．地域への分割を行った後は，各地域内での移動が活発になると想定される．地域内での標高の差があまりに大きいと移動が大変であるため，同じ地域内での標高差ができるだけ小さくなるように分割を行いたい．すなわち，地域 JOI の中での標高の最大値と最小値の差と，地域 IOI の中での標高の最大値と最小値の差のうち，大きい方の値を最小化したい．</p>

<div class="part">
<section>
<h3>課題</h3>
<p>JOIOI 王国の各マスの標高が与えられたとき，条件を満たすように地域の分割をした際の，地域 JOI の中での標高の最大値と最小値の差と，地域 IOI の中での標高の最大値と最小値の差のうち，大きい方の値の最小値を求めるプログラムを作成せよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>標準入力から以下の入力を読み込め．</p>
<ul>
<li><var>1</var> 行目には，<var>2</var> 個の整数 <var>H, W</var> が空白を区切りとして書かれている．これらは，JOIOI 国が <var>H</var> 行 <var>W</var> 列のマスに区切られた長方形の形をしていることを表す．</li>
<li>続く <var>H</var> 行のうちの <var>i</var> 行目 (<var>1 \leqq i \leqq H</var>) には，<var>W</var> 個の整数 <var>A_{i, 1}, A_{i, 2}, \ldots, A_{i, W}</var> が空白を区切りとして書かれている．これは，JOIOI 王国の上から <var>i</var> 行目，左から <var>j</var> 列目 (<var>1 \leqq j \leqq W</var>) の標高が <var>A_{i, j}</var> であることを表す．</li>
</ul>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>標準出力に，条件を満たすように地域の分割をした際の，地域 JOI の中での標高の最大値と最小値の差と，地域 IOI の中での標高の最大値と最小値の差のうち，大きい方の値の最小値を <var>1</var> 行で出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>制限</h3>
<p>すべての入力データは以下の条件を満たす．</p>
<ul>
<li><var>2 \leqq H \leqq 2\,000</var>．</li>
<li><var>2 \leqq W \leqq 2\,000</var>．</li>
<li><var>1 \leqq A_{i, j} \leqq 1\,000\,000\,000</var> (<var>1 \leqq i \leqq H</var>，<var>1 \leqq j \leqq W</var>)．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題 1 [15 点]</h3>
<p>以下の条件を満たす．</p>
<ul>
<li><var>H \leqq 10</var>．</li>
<li><var>W \leqq 10</var>．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題 2 [45 点]</h3>
<p>以下の条件を満たす．</p>
<ul>
<li><var>H \leqq 200</var>．</li>
<li><var>W \leqq 200</var>．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題 3 [40 点]</h3>
<p>追加の制限はない．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>4 4
1 12 6 11
11 10 2 14
10 1 9 20
4 17 19 10
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>11
</pre>
<p>この入力例では，例えば下の図のように地域を分割すればよい．ここで，J は地域 JOI，I は地域 IOI を表す．</p>
<pre>J J J I
J J J I
J J I I
J I I I
</pre>
<p>ここで，例えば次のような分割は，左から <var>3</var> 列目において地域 IOI がひとつながりになっていないため，条件を満たす分割ではない．</p>
<pre>J J I I
J J J I
J J J I
J I I I
</pre>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>8 6
23 23 10 11 16 21
15 26 19 28 19 20
25 26 28 16 15 11
11 8 19 11 15 24
14 19 15 14 24 11
10 8 11 7 6 14
23 5 19 23 17 17
18 11 21 14 20 16
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>18
</pre></section>
</div>
</span>
</span>
