<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3>
<p><var>N</var> 個のキャットタワーがあり，それぞれに <var>1</var> から <var>N</var> までの番号が付けられている．
タワー <var>i</var> (<var>1 \leqq i \leqq N</var>) の高さは <var>P_i</var> である．
タワーの高さは <var>1</var> 以上 <var>N</var> 以下の相異なる整数である．
<var>N-1</var> 組のタワーが隣接しており，各 <var>j</var> (<var>1 \leqq j \leqq N-1</var>) について，
タワー <var>A_j</var> とタワー <var>B_j</var> が隣接している．
はじめ，どのタワーからどのタワーへも隣接するタワーへ移動する操作を繰り返して移動できる．</p>
<p>最初，猫が高さ <var>N</var> のタワーの上にいる．</p>
<p>次に，<strong>キャットエクササイズ</strong>を行う．
キャットエクササイズとは，<var>1</var> つのタワーを選んでそこに障害物を置く操作の繰り返しである．
ただし，既に障害物を置いたタワーに再び障害物を置くことはできない．
操作によって以下のことが起こる．</p>
<ul>
<li>選んだタワーに猫がいない場合，何も起こらない．</li>
<li>選んだタワーに猫がおり，かつそれに隣接するタワーすべてに障害物が置かれている場合，キャットエクササイズが終了する．</li>
<li>いずれでもない場合，障害物が置かれていない隣接するタワーへの移動を繰り返して選んだタワーから移動できるタワーのうち，選んだタワーを除いて最も高いタワーへ，隣接するタワーへの移動を繰り返すことで猫が移動する．このとき，猫は隣接するタワーへの移動の回数が最小になるように移動する．</li>
</ul>
<p>タワーの高さと隣接するタワーの組の情報が与えられたとき，
障害物の置き方を工夫したときの，猫が隣接するタワーへ移動する回数の合計の最大値を求めるプログラムを作成せよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は以下の形式で標準入力から与えられる．</p>
<pre><var>N</var>
<var>P_1</var> <var>P_2</var> <var>\cdots</var> <var>P_N</var>
<var>A_1</var> <var>B_1</var>
<var>A_2</var> <var>B_2</var>
<var>\vdots</var>
<var>A_{N-1}</var> <var>B_{N-1}</var>
</pre>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>標準出力に，猫が隣接するタワーへ移動する回数の合計の最大値を <var>1</var> 行で出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>制約</h3>
<ul>
<li><var>2 \leqq N \leqq 200\,000</var>．</li>
<li><var>1 \leqq P_i \leqq N</var> (<var>1 \leqq i \leqq N</var>)．</li>
<li><var>P_i \neq P_j</var> (<var>1 \leqq i &lt; j \leqq N</var>)．</li>
<li><var>1 \leqq A_j &lt; B_j \leqq N</var> (<var>1 \leqq j \leqq N-1</var>)．</li>
<li>はじめ，どのタワーからどのタワーへも隣接するタワーへ移動する操作を繰り返して移動できる．</li>
<li>入力される値はすべて整数である． </li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題</h3>
<ol>
<li>(<var>7</var> 点) <var>A_i=i</var>，<var>B_i=i+1</var> (<var>1 \leqq i \leqq N-1</var>)，<var>N \leqq 16</var>．</li>
<li>(<var>7</var> 点) <var>A_i=i</var>，<var>B_i=i+1</var> (<var>1 \leqq i \leqq N-1</var>)，<var>N \leqq 300</var>．</li>
<li>(<var>7</var> 点) <var>A_i=i</var>，<var>B_i=i+1</var> (<var>1 \leqq i \leqq N-1</var>)，<var>N \leqq 5\,000</var>．</li>
<li>(<var>10</var> 点) <var>N \leqq 5\,000</var>．</li>
<li>(<var>20</var> 点) <var>A_i=i</var>，<var>B_i=i+1</var> (<var>1 \leqq i \leqq N-1</var>)．</li>
<li>(<var>23</var> 点) <var>A_i=\left\lfloor \frac{i+1}{2} \right\rfloor</var>，<var>B_i=i+1</var> (<var>1 \leqq i \leqq N-1</var>)．ただし，<var>\lfloor x \rfloor</var> は <var>x</var> の小数点以下を切り捨てた値を表す．</li>
<li>(<var>26</var> 点) 追加の制約はない．</li>
</ol>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>4
3 4 1 2
1 2
2 3
3 4
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>3
</pre>
<p>以下のようにキャットエクササイズを行ったとき，猫は合計 <var>3</var> 回移動する．</p>
<ul>
<li>タワー <var>1</var> に障害物を置く．このとき，猫は移動しない．</li>
<li>タワー <var>2</var> に障害物を置く．このとき，猫はタワー <var>2</var> からタワー <var>3</var> へ移動し，続いてタワー <var>3</var> からタワー <var>4</var> へと移動する．</li>
<li>タワー <var>4</var> に障害物を置く．このとき，猫はタワー <var>4</var> からタワー <var>3</var> へと移動する．</li>
<li>タワー <var>3</var> に障害物を置く．ここでキャットエクササイズが終了する．</li>
</ul>
<p>猫が <var>4</var> 回以上隣接するタワーへの移動を行うキャットエクササイズの方法は存在しないため，<var>3</var> を出力する．</p>
<p>この入力例は小課題 <var>1,2,3,4,5,7</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>7
3 2 7 1 5 4 6
1 2
1 3
2 4
2 5
3 6
3 7
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>7
</pre>
<p>この入力例は小課題 <var>4,6,7</var> の制約を満たす．</p></section>
</div>
</span>
</span>
