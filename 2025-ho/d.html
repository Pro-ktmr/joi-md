<span class="lang">
<span class="lang-en">
<p>Score: <var>100</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3>
<p>Just Odd Inventions Co., Ltd. is a company renowned for doing "just odd inventions."
Here we just call it JOI Company.</p>
<p>To celebrate the 5th anniversary of their flagship product, "Just Long Neckties," JOI Company has invented a new product: "Just Stretchable Neckties."
As its name suggests, this new necktie has the unique feature of being able to extend its length indefinitely.</p>
<p>JOI Company has decided to hold a showcase event to promote the new necktie, and you have been selected as the host of the event.
At the event, several models wearing the new neckties will appear on stage.
Initially, the <b>length</b> of every necktie worn by the models is set to <var>1</var>.</p>
<p>After that, you will carry out a total of <var>N</var> <b>performances</b> to demonstrate the necktie's stretchable feature to the audience.
Each performance is conducted as follows:</p>
<ol>

<li> First, you ask the audience to call out a number of their choice.
Let this number be <var>x</var>.

<li> Next, you decide whether to respond or ignore it.

<ul>

<li> If you choose to respond to it, you must select one of the models on stage whose necktie length is currently <b>less than or equal to</b> <var>x</var> and set the length of that model's necktie to exactly <var>x</var>.
(Note that you may select a model whose necktie length is already <var>x</var>.)
However, if no model can be selected, the showcase event will fail.

<li> If you choose to ignore it, you do nothing.
</ul>
</ol>

<p>However, if you ignore the audience's number two or more times in a row, the audience will get angry, and the showcase event will fail.</p>
<p>The number of models on stage, denoted as <var>k</var> (<var>k\geq 1</var>), has not yet been determined.
Since hiring models costs considerable money, it is desirable to keep <var>k</var> as small as possible.
The minimum value of <var>k</var> required to prevent the showcase event from failing depends on the numbers called out by the audience during the performances.
Fortunately, you possess precognitive abilities and have foreseen that the number called out by the audience during the <var>i</var>-th performance (<var>1\leq i\leq N</var>) will be <var>A_i</var>.</p>
<p>Write a program which, given the numbers called out by the audience during the showcase event, calculates the minimum number of models <var>k</var> required to prevent the showcase event from failing.</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>Input</h3>
<p>Read the following data from the standard input.</p>
<pre><var>N</var>
<var>A_1</var> <var>A_2</var> <var>\cdots</var> <var>A_N</var>
</pre>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>Output</h3>
<p>Write one line to the standard output.
The output should contain the minimum number of models <var>k</var> required to prevent the showcase event from failing.</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>Constraints</h3>
<ul>
<li> <var>2 \leq N \leq 5\,000\,000</var>.
<li> <var>1\leq A_i \leq 21</var> (<var>1 \leq i \leq N</var>).
<li> Given values are all integers.
</ul>

</section>
</div>

<div class="part">
<section>
<h3>Subtasks</h3>
<ol>
<li> (<var>10</var> points) <var>N\leq 15</var>.
<li> (<var>6</var> points) <var>N\leq 500</var>, <var>A_i \leq 2</var> (<var>1 \leq i \leq N</var>).
<li> (<var>12</var> points) <var>N\leq 500</var>, <var>A_i \leq 5</var> (<var>1 \leq i \leq N</var>).
<li> (<var>18</var> points) <var>N\leq 500</var>, <var>A_i \leq 15</var> (<var>1 \leq i \leq N</var>).
<li> (<var>26</var> points) <var>N\leq 500\,000</var>, <var>A_i \leq 15</var> (<var>1 \leq i \leq N</var>).
<li> (<var>10</var> points) <var>N\leq 500\,000</var>.
<li> (<var>18</var> points) No additional constraints.
</ol>

<hr />
</section>
</div>

<div class="part">
<section>
<h3>Sample Input 1</h3>
<pre>5
5 3 4 2 1
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3>
<pre>2
</pre>
<p>When <var>k=2</var>, the showcase event can be conducted as follows, for example:</p>
<ul>

<li> First, two models wearing the new neckties appear on stage. Initially, the length of each model's necktie is <var>1</var>.

<li> During the 1st performance, the audience calls out <var>5</var>. You ignore this.

<li> During the 2nd performance, the audience calls out <var>3</var>. You respond to this by selecting the first model and setting their necktie length to <var>3</var>. The necktie lengths of the two models are now <var>3</var> and <var>1</var>, respectively.

<li> During the 3rd performance, the audience calls out <var>4</var>. You respond to this by selecting the first model and setting their necktie length to <var>4</var>. The necktie lengths of the two models are now <var>4</var> and <var>1</var>, respectively.

<li> During the 4th performance, the audience calls out <var>2</var>. You respond to this by selecting the second model and setting their necktie length to <var>2</var>. The necktie lengths of the two models are now <var>4</var> and <var>2</var>, respectively.

<li> During the 5th performance, the audience calls out <var>1</var>. You ignore this.
</ul>

<p>When <var>k=1</var>, the showcase event will always fail.
For example, if you respond to the audience's numbers during the 2nd, 3rd, and 4th performances as described above, the only model's necktie length becomes <var>4</var> after the 3rd performance.
Then, at the 4th performance, you cannot select a model whose necktie length is less than or equal to <var>2</var>, so the showcase event fails.</p>
<p>Hence, the minimum number of models <var>k</var> required to prevent the showcase event from failing is <var>2</var>, and the output should be <var>2</var>.</p>
<p>This sample input satisfies the constraints of Subtasks <var>1,3,4,5,6,</var> and <var>7</var>.</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>Sample Input 2</h3>
<pre>6
2 1 1 2 2 1
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3>
<pre>1
</pre>
<p>When <var>k=1</var>, the showcase event can be conducted as follows, for example:</p>
<ul>

<li> First, a model wearing the new necktie appear on stage. Initially, the length of the model's necktie is <var>1</var>.

<li> During the 1st performance, the audience calls out <var>2</var>. You ignore this.

<li> During the 2nd performance, the audience calls out <var>1</var>. You respond to this by selecting the only model on stage and setting their necktie length to <var>1</var>.

<li> During the 3rd performance, the audience calls out <var>1</var>. You respond to this by selecting the only model on stage and setting their necktie length to <var>1</var>.

<li> During the 4th performance, the audience calls out <var>2</var>. You respond to this by selecting the only model on stage and setting their necktie length to <var>2</var>.

<li> During the 5th performance, the audience calls out <var>2</var>. You respond to this by selecting the only model on stage and setting their necktie length to <var>2</var>.

<li> During the 6th performance, the audience calls out <var>1</var>. You ignore this.
</ul>

<p>Note that in the example above, during the 2nd and 3rd performances, a model whose necktie length is already <var>1</var> is selected, and their necktie length is set to <var>1</var> again.
Such a choice, where the necktie length does not change, is also allowed.</p>
<p>Hence, the minimum number of models <var>k</var> required to prevent the showcase event from failing is <var>1</var>, and the output should be <var>1</var>.</p>
<p>This sample input satisfies the constraints of all the subtasks.</p>
<p>\newline</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>Sample Input 3</h3>
<pre>10
2 4 6 7 4 5 5 3 4 1
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3>
<pre>3
</pre>
<p>This sample input satisfies the constraints of Subtasks <var>1,4,5,6,</var> and <var>7</var>.</p></section>
</div>
</span>
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3>
<p>Just Odd Inventions 社は，「ただ奇妙な発明 (just odd inventions)」をすることで知られている会社である．
ここでは略して JOI 社と呼ぶ．</p>
<p>JOI 社は，看板商品である「長いだけのネクタイ」発売 <var>5</var> 周年を記念し，新しく「長くなるだけのネクタイ」を開発した．
この新型ネクタイの特徴は，その名の通り長さをいくらでも伸ばせることである．</p>
<p>JOI 社は，新型ネクタイの宣伝を目的とした披露会の開催を決定し，その司会にあなたを抜擢した．
披露会ではまず，新型ネクタイを着用した何人かのモデルが舞台上に登壇する．
最初，各モデルが着用しているネクタイの<b>長さ</b>はすべて <var>1</var> である．</p>
<p>その後，あなたはネクタイの長さを伸ばせる機能を観客に実感してもらうための<b>パフォーマンス</b>を <var>N</var> 回行う．
各パフォーマンスは以下のように行われる．</p>
<ol>
<li> まず，観客に好きな数を <var>1</var> つ唱えてもらう．ここで観客が唱えた数を <var>x</var> とおく．
<li> 次に，司会のあなたはこれに反応するか無視するかを選ぶ．
<ul>
<li> 反応することを選んだ場合，あなたは登壇しているモデルのうち着用しているネクタイの長さが <var>x</var> <b>以下</b>であるような者を <var>1</var> 人選び，そのモデルのネクタイの長さを <var>x</var> にする（着用しているネクタイの長さが元々 <var>x</var> であるようなモデルも選ぶことができる点に注意せよ）．
ただし，選ぶことのできるモデルが <var>1</var> 人も存在しない場合，披露会は失敗に終わる．
<li> 無視することを選んだ場合，何もしない．
</ul>
</ol>

<p>ただし，観客の唱えた数を <var>2</var> 回以上連続で無視してしまうと，観客が機嫌を損ね，披露会は失敗に終わる．</p>
<p>舞台上に登壇させるモデルの人数 <var>k</var> (<var>k\geqq 1</var>) はまだ決まっていないが，モデルを雇うのにはお金がかかるため，<var>k</var> の値はできるだけ小さい方が望ましい．
披露会が失敗に終わらないために必要なモデルの人数は各パフォーマンスで観客が唱える数に依存するが，あなたはその予知能力により，<var>i</var> 回目 (<var>1\leqq i\leqq N</var>) のパフォーマンスで観客が唱える数が <var>A_i</var> であることを予見した．</p>
<p>披露会で観客が唱える数の情報が与えられたとき，披露会が失敗に終わらないために必要なモデルの人数 <var>k</var> の最小値を求めるプログラムを作成せよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は以下の形式で標準入力から与えられる．</p>
<pre><var>N</var>
<var>A_1</var> <var>A_2</var> <var>\cdots</var> <var>A_N</var>
</pre>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>標準出力に，披露会が失敗に終わらないために必要なモデルの人数 <var>k</var> の最小値を <var>1</var> 行で出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>制約</h3>
<ul>
<li> <var>2 \leqq N \leqq 5\,000\,000</var>．
<li> <var>1\leqq A_i \leqq 21</var> (<var>1 \leqq i \leqq N</var>)．
<li> 入力される値はすべて整数である．
</ul>

</section>
</div>

<div class="part">
<section>
<h3>小課題</h3>
<ol>
<li> (<var>10</var> 点) <var>N\leqq 15</var>．
<li> (<var>6</var> 点) <var>N\leqq 500</var>，<var>A_i \leqq 2</var> (<var>1 \leqq i \leqq N</var>)．
<li> (<var>12</var> 点) <var>N\leqq 500</var>，<var>A_i \leqq 5</var> (<var>1 \leqq i \leqq N</var>)．
<li> (<var>18</var> 点) <var>N\leqq 500</var>，<var>A_i \leqq 15</var> (<var>1 \leqq i \leqq N</var>)．
<li> (<var>26</var> 点) <var>N\leqq 500\,000</var>，<var>A_i \leqq 15</var> (<var>1 \leqq i \leqq N</var>)．
<li> (<var>10</var> 点) <var>N\leqq 500\,000</var>．
<li> (<var>18</var> 点) 追加の制約はない．
</ol>

<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>5
5 3 4 2 1
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>2
</pre>
<p><var>k=2</var> のとき，例えば以下のように披露会を行うことができる．</p>
<ul>
<li> まず，新型ネクタイを着用した <var>2</var> 人のモデルが舞台上に登壇する．最初，各モデルのネクタイの長さはいずれも <var>1</var> である．
<li> <var>1</var> 回目のパフォーマンスでは，観客は <var>5</var> を唱える．あなたはこれを無視する．
<li> <var>2</var> 回目のパフォーマンスでは，観客は <var>3</var> を唱える．あなたはこれに反応して，<var>1</var> 人目のモデルを選び，そのネクタイの長さを <var>3</var> にする．各モデルのネクタイの長さはそれぞれ <var>3,1</var> になる．
<li> <var>3</var> 回目のパフォーマンスでは，観客は <var>4</var> を唱える．あなたはこれに反応して，<var>1</var> 人目のモデルを選び，そのネクタイの長さを <var>4</var> にする．各モデルのネクタイの長さはそれぞれ <var>4,1</var> になる．
<li> <var>4</var> 回目のパフォーマンスでは，観客は <var>2</var> を唱える．あなたはこれに反応して，<var>2</var> 人目のモデルを選び，そのネクタイの長さを <var>2</var> にする．各モデルのネクタイの長さはそれぞれ <var>4,2</var> になる．
<li> <var>5</var> 回目のパフォーマンスでは，観客は <var>1</var> を唱える．あなたはこれを無視する．
</ul>

<p><var>k=1</var> のとき，披露会は必ず失敗に終わる．
例えば，上記の進行例のように <var>2,3,4</var> 回目のパフォーマンスで観客の唱えた数に反応した場合，<var>3</var> 回目のパフォーマンスが終了した時点で登壇している唯一のモデルのネクタイの長さが <var>4</var> になっているため，
<var>4</var> 回目のパフォーマンスにおいて，着用しているネクタイの長さが <var>2</var> 以下であるようなモデルを選ぶことができず，披露会は失敗に終わる．</p>
<p>よって，披露会が失敗に終わらないために必要なモデルの人数 <var>k</var> の最小値は <var>2</var> であるため，<var>2</var> を出力する．</p>
<p>この入力例は小課題 <var>1,3,4,5,6,7</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>6
2 1 1 2 2 1
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>1
</pre>
<p><var>k=1</var> のとき，例えば以下のように披露会を行うことができる．</p>
<ul>
<li> まず，新型ネクタイを着用した <var>1</var> 人のモデルが舞台上に登壇する．最初，モデルのネクタイの長さは <var>1</var> である．
<li> <var>1</var> 回目のパフォーマンスでは，観客は <var>2</var> を唱える．あなたはこれを無視する．
<li> <var>2</var> 回目のパフォーマンスでは，観客は <var>1</var> を唱える．あなたはこれに反応して，登壇している唯一のモデルを選び，そのネクタイの長さを <var>1</var> にする．
<li> <var>3</var> 回目のパフォーマンスでは，観客は <var>1</var> を唱える．あなたはこれに反応して，登壇している唯一のモデルを選び，そのネクタイの長さを <var>1</var> にする．
<li> <var>4</var> 回目のパフォーマンスでは，観客は <var>2</var> を唱える．あなたはこれに反応して，登壇している唯一のモデルを選び，そのネクタイの長さを <var>2</var> にする．
<li> <var>5</var> 回目のパフォーマンスでは，観客は <var>2</var> を唱える．あなたはこれに反応して，登壇している唯一のモデルを選び，そのネクタイの長さを <var>2</var> にする．
<li> <var>6</var> 回目のパフォーマンスでは，観客は <var>1</var> を唱える．あなたはこれを無視する．
</ul>

<p>なお，上記の進行例における <var>2,3</var> 回目のパフォーマンスでは，元々ネクタイの長さが <var>1</var> であるようなモデルを選んでそのネクタイの長さを <var>1</var> にしているが，そのように，ネクタイの長さが変化しないようなモデルの選び方も許されていることに注意せよ．</p>
<p>よって，披露会が失敗に終わらないために必要なモデルの人数 <var>k</var> の最小値は <var>1</var> であるため，<var>1</var> を出力する．</p>
<p>この入力例はすべての小課題の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 3</h3>
<pre>10
2 4 6 7 4 5 5 3 4 1
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3>
<pre>3
</pre>
<p>この入力例は小課題 <var>1,4,5,6,7</var> の制約を満たす．</p></section>
</div>
</span>
</span>
