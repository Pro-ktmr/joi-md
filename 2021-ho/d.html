<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3></h3>
<p>IOI 町には <var>N</var> 個の交差点があり，<var>1</var> から <var>N</var> までの番号が付いている．また，<var>M</var> 本の道があり，<var>1</var> から <var>M</var> までの番号が付いている．それぞれの道は <var>2</var> 個の異なる交差点を双方向に結んでいる．道 <var>i</var> (<var>1 \leqq i \leqq M</var>) は交差点 <var>A_i</var> と交差点 <var>B_i</var> を結んでいる．<var>2</var> 本の異なる道が同じ交差点の組を結ぶことはない．これらの道には <var>1</var> 以上 <var>M</var> 以下の整数で表される色が塗られており，道 <var>i</var> の現在の色は <var>C_i</var> である．複数の道が同じ色で塗られているかもしれない．</p>
<p>JOI 社は IOI 町の交差点を移動するロボットを開発した．あなたがこのロボットに道の色を指示すると，ロボットは指示された色の道を通り隣接した交差点に移動する．ただし，ロボットが現在いる交差点につながれた道のうちに，指示された色の道が <var>2</var> 本以上存在すると，次に進むべき道を判別できずに停止してしまう．</p>
<p>あなたの目的は，現在交差点 <var>1</var> にいるロボットに何回かの指示を出して，交差点 <var>N</var> に移動させることである．ただし，現在の道の色ではそれができるとは限らないため，何本かの道の色を<strong>事前に</strong>塗り替えることで，
ロボットを交差点 <var>N</var> に移動させることができるようにしたい．道 <var>i</var> (<var>1 \leqq i \leqq M</var>) は <var>P_i</var> 円をかけて，<var>1</var> 以上 <var>M</var> 以下の好きな整数の色に塗り替えることが出来る．</p>
<p>交差点と道の情報が与えられたとき，必要な金額の最小値を求めるプログラムを作成せよ．ただし，どのように道の色を塗り替えてもロボットを交差点 <var>N</var> に移動させることができない場合は，代わりに <code>-1</code> を出力せよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は以下の形式で標準入力から与えられる．入力される値はすべて整数である．</p>
<pre><var>N</var> <var>M</var>
<var>A_1</var> <var>B_1</var> <var>C_1</var> <var>P_1</var>
<var>\vdots</var>
<var>A_M</var> <var>B_M</var> <var>C_M</var> <var>P_M</var>
</pre>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>標準出力に必要な金額の最小値を <var>1</var> 行で出力せよ．ただし，どのように道の色を塗り替えてもロボットを交差点 <var>N</var> に移動させることができない場合は，代わりに <code>-1</code> を出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>制約</h3>
<ul>
<li><var>2 \leqq N \leqq 100\,000</var>．</li>
<li><var>1 \leqq M \leqq 200\,000</var>．</li>
<li><var>1 \leqq A_i &lt; B_i \leqq N</var> (<var>1 \leqq i \leqq M</var>)．</li>
<li><var>(A_i, B_i) \neq (A_j, B_j)</var> (<var>1 \leqq i &lt; j \leqq M</var>)．</li>
<li><var>1 \leqq C_i \leqq M</var> (<var>1 \leqq i \leqq M</var>)．</li>
<li><var>1 \leqq P_i \leqq 1\,000\,000\,000</var> (<var>1 \leqq i \leqq M</var>)．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題</h3>
<ol>
<li>(<var>34</var> 点) <var>N \leqq 1\,000</var>，<var>M \leqq 2\,000</var>．</li>
<li>(<var>24</var> 点) <var>P_i = 1</var> (<var>1 \leqq i \leqq M</var>)．</li>
<li>(<var>42</var> 点) 追加の制約はない．</li>
</ol>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>4 6
1 4 4 4
3 4 1 3
1 3 4 4
2 4 3 1
2 3 3 2
1 2 4 2
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>3
</pre>
<p><var>1</var> 円で道 <var>4</var> を色 <var>3</var> から色 <var>4</var> に塗り替え，<var>2</var> 円で道 <var>6</var> を色 <var>4</var> から色 <var>2</var> に塗り替える．合計 <var>3</var> 円かかる．</p>
<p>この結果，交差点 <var>1</var> にいるロボットに色 <var>2</var> を指示することで，ロボットを交差点 <var>2</var> に移動させることができる．続けて，ロボットに色 <var>4</var> を指示することで，ロボットを交差点 <var>4</var> に移動させることができる．</p>
<p><var>2</var> 円以下でロボットを交差点 <var>4</var> に移動させることは不可能であるため，<var>3</var> を出力する．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>5 2
1 4 1 2
3 5 1 4
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>-1
</pre>
<p>道をどのように塗り替えても，ロボットを交差点 <var>5</var> に移動させることはできない．したがって，<var>-1</var> を出力する．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 3</h3>
<pre>5 7
2 3 7 1
1 4 5 1
4 5 3 1
3 4 7 1
2 4 3 1
3 5 6 1
1 2 5 1
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3>
<pre>1
</pre>
<p>この入力例は小課題 <var>2</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 4</h3>
<pre>13 21
7 10 4 4
3 6 4 7
8 10 4 5
3 9 2 5
1 4 4 5
2 6 4 2
3 11 2 2
3 8 16 2
8 11 16 1
6 10 4 14
6 8 16 6
9 12 16 5
5 13 4 6
1 12 4 7
2 4 4 18
2 9 4 10
2 12 4 6
10 13 4 28
5 7 2 5
5 11 2 16
7 13 4 20
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3>
<pre>7
</pre></section>
</div>
</span>
</span>
