<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題</h3>
<p>日本が冬であるこの時期，南半球にあるオーストラリアでは暑い日が続いている．オーストラリアに住む IOI 君は，ある <var>D</var> 日間の天気予報をもとに，着る服の計画を立てることにした．<var>i</var> 日目 (<var>1 \leqq i \leqq D</var>) の最高気温は <var>T_i</var> 度であると予報されている．</p>
<p>IOI 君は <var>N</var> 種類の服を持っており，それらには <var>1</var> から <var>N</var> までの番号がついている．服 <var>j</var> (<var>1 \leqq j \leqq N</var>) は最高気温が <var>A_j</var> 度以上 <var>B_j</var> 度以下の日に着るのに適している．また，それぞれの服には「派手さ」とよばれる整数が定まっており，服 <var>j</var> の派手さは <var>C_j</var> である．</p>
<p><var>D</var> 日間のそれぞれに対し，IOI 君は，最高気温が天気予報に従ったときに着るのに適した服のうち <var>1</var> つを着る服として選ぶ．同じ服を何度選んでもよいし，<var>D</var> 日間で一度も選ばれない服があってもよい．</p>
<p>似ている服を連続して着ることをなるべく避けようと思った IOI 君は，連続する日に着る服の派手さの差の絶対値の合計をできるだけ大きくしようと考えた．すなわち，<var>i</var> 日目に服 <var>x_i</var> を選んだとして，値 <var>|C_{x_1} - C_{x_2}| + |C_{x_2} - C_{x_3}| + \cdots + |C_{x_{D-1}} - C_{x_D}|</var> を最大にしたい．この最大値を求めるプログラムを作成せよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は <var>1 + D + N</var> 行からなる．</p>
<p><var>1</var> 行目には，<var>2</var> つの整数 <var>D, N</var> (<var>2 \leqq D \leqq 200</var>，<var>1 \leqq N \leqq 200</var>) が空白を区切りとして書かれている．<var>D</var> は服の計画を立てる日数，<var>N</var> は IOI 君が持っている服の種類の数を表す．</p>
<p>続く <var>D</var> 行のうちの <var>i</var> 行目 (<var>1 \leqq i \leqq D</var>) には，<var>1</var> つの整数 <var>T_i</var> (<var>0 \leqq T_i \leqq 60</var>) が書かれている．これは，<var>i</var> 日目の最高気温が <var>T_i</var> 度であると予報されていることを表す．</p>
<p>続く <var>N</var> 行のうちの <var>j</var> 行目 (<var>1 \leqq j \leqq N</var>) には，<var>3</var> つの整数 <var>A_j, B_j, C_j</var> (<var>0 \leqq A_j \leqq B_j \leqq 60</var>，<var>0 \leqq C_j \leqq 100</var>) が書かれている．これらは，服 <var>j</var> は最高気温が <var>A_j</var> 度以上 <var>B_j</var> 度以下の日に着るのに適しており，派手さが <var>C_j</var> であることを表す．</p>
<p>最高気温が天気予報に従ったときに着るのに適した服が，<var>D</var> 日間のどの日に対しても <var>1</var> つ以上存在することが保証されている．</p>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>連続する日に着る服の派手さの差の絶対値の合計，すなわち，値 <var>|C_{x_1} - C_{x_2}| + |C_{x_2} - C_{x_3}| + \cdots + |C_{x_{D - 1}} - C_{x_D}|</var> の最大値を <var>1</var> 行で出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>3 4
31
27
35
20 25 30
23 29 90
21 35 60
28 33 40
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>80
</pre>
<p>入出力例 <var>1</var> において，<var>1</var> 日目の服の候補は服 <var>3</var> と服 <var>4</var> であり，<var>2</var> 日目の服の候補は服 <var>2</var> と服 <var>3</var> であり，<var>3</var> 日目の服の候補は服 <var>3</var> のみである．<var>1</var> 日目に服 <var>4</var> を，<var>2</var> 日目に服 <var>2</var> を，<var>3</var> 日目に服 <var>3</var> を選ぶ．すなわち，<var>x_1 = 4</var>，<var>x_2 = 2</var>，<var>x_3 = 3</var> とする．このとき，<var>1</var> 日目と <var>2</var> 日目の服の派手さの差の絶対値は <var>|40 - 90| = 50</var> であり，<var>2</var> 日目と <var>3</var> 日目の服の派手さの差の絶対値は <var>|90 - 60| = 30</var> である．合計は <var>80</var> となり，これが最大値である．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>5 2
26
28
32
29
34
30 35 0
25 30 100
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>300
</pre>
<p>入出力例 <var>2</var> において，<var>1</var> 日目には服 <var>2</var> を，<var>2</var> 日目には服 <var>2</var> を，<var>3</var> 日目には服 <var>1</var> を，<var>4</var> 日目には服 <var>2</var> を，<var>5</var> 日目には服 <var>1</var> を選ばなければならない．このとき，求める値は <var>|100 - 100| + |100 - 0| + |0 - 100| + |100 - 0| = 300</var> となる．</p></section>
</div>
</span>
</span>
