<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題</h3>
<p>JOI 君は家族とともに海水浴に来た．さんざん泳いで泳ぎ疲れた JOI 君は，次は砂浜で砂の城を作って遊んだ．しばらくして砂遊びにも飽きると，JOI 君は城を放置してまた海に泳ぎに向かった．</p>
<p>JOI 君が作った城は，砂浜のうちのある長方形の領域に含まれている．この長方形の領域は，東西南北にマス目状に区切られている．各マスは，JOI 君が作った城の一部であるマス (以下，「城マス」と呼ぶ) かそうでないマス (以下，「更地マス」と呼ぶ) のいずれかである．それぞれの城マスには「強度」と呼ばれる <var>1</var> 以上 <var>9</var> 以下の整数が定まっている．長方形の領域の外縁部，すなわち外側と接しているマスには城マスは存在しない．</p>
<p>やがて潮が満ちてきて，長方形の領域にも波が押し寄せてくるようになった．波が <var>1</var> つ押し寄せてくるたびに，城マスのうち次の条件を満たすものはすべて一斉に崩壊して，更地マスに変化する．</p>
<p>条件：周囲の <var>8</var> マス (東西南北および北東，北西，南東，南西方向に隣接するマス) にある更地マスの数が，そのマスの強度の値以上である．
波が引くと，まもなく次の波が押し寄せて来る．</p>
<p>十分多くの波が押し寄せると，城がすべて崩れてしまうか，丈夫な部分だけが残るかして，波が押し寄せてきても <var>1</var> つも城マスが崩壊しないような状態に落ち着く．<var>1</var> つ以上の城マスを崩壊させるような波が押し寄せてくる回数を求めよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は <var>1 + H</var> 行からなる．</p>
<p><var>1</var> 行目には，<var>2</var> つの整数 <var>H, W</var> (<var>2 \leqq H \leqq 1000</var>，<var>2 \leqq W \leqq 1000</var>) が空白を区切りとして書かれている．これは，長方形の領域が縦 <var>H</var> 行，横 <var>W</var> 列の <var>H \times W</var> 個のマスに区切られていることを表す．長方形の縦方向は南北方向であり，横方向は東西方向である．</p>
<p>続く <var>H</var> 行にはそれぞれ <var>W</var> 文字からなる文字列が書かれており，最初の波が押し寄せてくる前の長方形の領域の状態を表す．<var>H</var> 行のうちの <var>i</var> 行目の左から <var>j</var> 番目の文字 (<var>1 \leqq i \leqq H</var>，<var>1 \leqq j \leqq W</var>) は，長方形の領域の北から i 行目，西から j 列目のマスが更地マスである場合は <code>.</code> (ピリオド) である．城マスである場合は <code>1</code>, <code>2</code>, <var>\ldots</var>, <code>9</code> のいずれかであり，そのマスの強度を表す．</p>
<p>長方形の領域の外縁部はすべて更地マスである．すなわち，すべての入力において，<var>1</var> 行目または <var>H</var> 行目の文字と，各行の左から <var>1</var> 番目または <var>W</var> 番目の文字はすべて <code>.</code> である．</p>
<p>与えられる入力データのうち，入力 <var>1</var> では <var>H \leqq 50</var>，<var>W \leqq 50</var> を満たす．</p>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p><var>1</var> つ以上の城マスを崩壊させるような波が押し寄せてくる回数を <var>1</var> 行で出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>5 6
......
.939..
.3428.
.9393.
......
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>3
</pre>
<p>入出力例 <var>1</var> においては，初めに押し寄せる波で強度 <var>3</var> の城マスがすべて崩壊し，</p>
<pre>......
.9.9..
..428.
.9.9..
......
</pre>
<p>という状態になる．</p>
<p>次に押し寄せてくる波では強度 <var>2</var> の城マスが崩壊し，</p>
<pre>......
.9.9..
..4.8.
.9.9..
......
</pre>
<p>という状態になる．</p>
<p>次に押し寄せてくる波では強度 <var>4</var> の城マスが崩壊し，</p>
<pre>......
.9.9..
....8.
.9.9..
......
</pre>
<p>という状態になる．</p>
<p>これ以降の波が城マスを崩すことはない．よって答えは <var>3</var> である．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>10 10
..........
.99999999.
.9.323239.
.91444449.
.91444449.
.91444449.
.91444449.
.91232329.
.99999999.
..........
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>35
</pre></section>
</div>
</span>
</span>
