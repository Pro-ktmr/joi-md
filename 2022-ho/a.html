<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3>
<p>時は <var>\mathrm{30XX}</var> 年．科学者・技術者のたゆまぬ努力により，異星間の交流が盛んに行われるようになっていた．ビーバーのビ太郎は異星人に地球の食べ物を紹介するアンバサダーを務めており，今日の午後 1 時に JOI 星へ向けて出発する予定である．</p>
<p>今回 JOI 星人に紹介する食べ物のひとつとして，切り分けたカステラが用意されている．カステラは小麦粉に鶏卵・砂糖・水あめを加え，スポンジ状にふっくらと焼いた菓子である．</p>
<p>カステラは横長の直方体の形をしており，縦方向の切れ目に沿って <var>N</var> 個のピースに分割されている．左から <var>i</var> 番目 (<var>1 \leqq i \leqq N</var>) のピースの長さは整数 <var>A_i</var> である．</p>
<p>つい先ほど，JOI 星人は偶数に嫌悪感を示すということが判明した．そこで対処として，長さが偶数のピースが無くなるまで以下の一連の操作を繰り返すことにした．</p>
<ol>
<li>長さが偶数のピースのうち最も右にあるものを選ぶ．</li>
<li>選んだピースを縦方向に切って <var>2</var> 等分する．すなわち，選んだピースの長さを <var>k</var> としたとき，そのピースを位置を変えずに長さ <var>\displaystyle\frac{k}{2}</var> のピース <var>2</var> つに分割する．</li>
</ol>
<p>操作が正しく行われたかチェックするため，ビ太郎は <var>Q</var> 個の質問を準備しておいた．<var>j</var> 番目 (<var>1 \leqq j \leqq Q</var>) の質問は以下の通りである．</p>
<ul>
<li>すべての操作が終了したとき，左から <var>X_j</var> 番目にあるピースの長さは何であるか．</li>
</ul>
<p>カステラと質問の情報が与えられたとき，各質問の答えを求めるプログラムを作成せよ．</p>
<p><img alt="" src="https://img.atcoder.jp/joi2022ho/t1-1.png" /></p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は以下の形式で標準入力から与えられる．入力される値はすべて整数である．</p>
<pre><var>N</var>
<var>A_1</var>
<var>A_2</var>
<var>\vdots</var>
<var>A_N</var>
<var>Q</var>
<var>X_1</var>
<var>X_2</var>
<var>\vdots</var>
<var>X_Q</var>
</pre>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>標準出力に <var>Q</var> 行出力せよ．<var>j</var> 行目 (<var>1 \leqq j \leqq Q</var>) には，<var>j</var> 番目の質問の答えを出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>制約</h3>
<ul>
<li><var>1 \leqq N \leqq 200\,000</var>．</li>
<li><var>1 \leqq A_i \leqq 1\,000\,000\,000</var> (<var>1 \leqq i \leqq N</var>)．</li>
<li><var>1 \leqq Q \leqq 200\,000</var>．</li>
<li><var>1 \leqq X_j \leqq 1\,000\,000\,000\,000\,000\ (= 10^{15})</var> (<var>1 \leqq j \leqq Q</var>)．</li>
<li><var>X_{j} \leqq X_{j + 1}</var> (<var>1 \leqq j \leqq Q - 1</var>)．</li>
<li>すべての操作が終了したとき，カステラは <var>X_Q</var> 個以上のピースに分割されている．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題</h3>
<ol>
<li>(<var>25</var> 点) <var>A_i \leqq 8</var> (<var>1 \leqq i \leqq N</var>)．</li>
<li>(<var>35</var> 点) <var>N \leqq 1\,000</var>，<var>Q \leqq 1\,000</var>．</li>
<li>(<var>40</var> 点) 追加の制約はない．</li>
</ol>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>4
14
9
8
12
6
2
3
5
7
11
13
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>7
9
1
1
1
3
</pre>
<p>はじめ，カステラの各ピースの長さは左から順に <var>14, 9, 8, 12</var> である．</p>
<p>一連の操作が終了したとき，カステラは <var>15</var> 個のピースに分割されており，各ピースの長さは左から順に <var>7, 7, 9, 1, 1, 1, 1, 1, 1, 1, 1, 3, 3, 3, 3</var> となる．</p>
<p>この入出力例は小課題 <var>2, 3</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>13
1
4
1
4
2
1
3
5
6
2
3
7
3
8
2
10
11
13
15
17
18
20
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>1
1
1
1
5
3
1
3
</pre>
<p>この入出力例はすべての小課題の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 3</h3>
<pre>16
536870912
402653184
536870912
536870912
134217728
536870912
671088640
536870912
536870912
536870912
939524096
805306368
536870912
956301312
536870912
536870912
5
2500000000
3355443201
4294967296
5111111111
6190792704
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3>
<pre>5
1
7
57
1
</pre>
<p>この入出力例は小課題 <var>2, 3</var> の制約を満たす．</p></section>
</div>
</span>
</span>
