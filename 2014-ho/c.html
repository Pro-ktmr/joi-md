<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3></h3>
<p>JOI 君は妹の JOI 子ちゃんと JOI 美ちゃんと一緒におやつを食べようとしている．今日のおやつは <var>3</var> 人の大好物のバームクーヘンだ．</p>
<p>バームクーヘンは下図のような円筒形のお菓子である．<var>3</var> 人に分けるために，JOI 君は半径方向に刃を <var>3</var> 回入れて，これを <var>3</var> つのピースに切り分けなければならない．ただしこのバームクーヘンは本物の木材のように固いので，刃を入れるのは簡単ではない．そのためこのバームクーヘンにはあらかじめ <var>N</var> 個の切れ込みが入っており，JOI 君は切れ込みのある位置でのみ切ることができる．切れ込みに <var>1</var> から <var>N</var> まで時計回りに番号をふったとき，<var>1 \leqq i \leqq N - 1</var> に対し，<var>i</var> 番目の切れ込みと <var>i + 1</var> 番目の切れ込みの間の部分の大きさは <var>A_i</var> である．また <var>N</var> 番目の切れ込みと <var>1</var> 番目の切れ込みの間の部分の大きさは <var>A_N</var> である．</p>
<p><img alt="図 1: バームクーヘンの例 <var>N = 6</var>，<var>A_1 = 1</var>，<var>A_2 = 5</var>，<var>A_3 = 4</var>，<var>A_4 = 5</var>，<var>A_5 = 2</var>，<var>A_6 = 4</var>" src="https://img.atcoder.jp/joi2014ho/2014-ho-t3-fig01.png" /></p>
<p>妹思いの JOI 君は，バームクーヘンを <var>3</var> つのピースに切り分けたあと，自分は最も小さいピースを選び，残りの <var>2</var> つのピースを <var>2</var> 人の妹にあげることにした．一方で，JOI 君はバームクーヘンが大好物なので，できるだけたくさん食べたいと思っている．最も小さいピースの大きさが最大になるように切ったとき，JOI 君が食べることになるピースの大きさはいくらになるだろうか．</p>
</section>
</div>

<div class="part">
<section>
<h3>課題</h3>
<p>切れ込みの個数 <var>N</var> と，各部分の大きさを表す整数 <var>A_1, \ldots, A_N</var> が与えられる．バームクーヘンを <var>3</var> つに切り分けたときの，最も小さいピースの大きさの最大値を出力するプログラムを作成せよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>標準入力から以下の入力を読み込め．</p>
<ul>
<li><var>1</var> 行目には，整数 <var>N</var> が書かれている．これはバームクーヘンに <var>N</var> 個の切れ込みがあることを表す．</li>
<li>続く <var>N</var> 行のうちの <var>i</var> 行目 (<var>1 \leqq i \leqq N</var>) には，整数 <var>A_i</var> が書かれている．これは <var>i</var> 番目の切れ込みと <var>i + 1</var> 番目の切れ込みの間の部分 (<var>i = N</var> のときは <var>N</var> 番目の切れ込みと <var>1</var> 番目の切れ込みの間の部分) の大きさが <var>A_i</var> であることを表す．</li>
</ul>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>標準出力に，バームクーヘンを <var>3</var> つに切り分けたときの，最も小さいピースの大きさの最大値を表す整数を <var>1</var> 行で出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>制限</h3>
<p>すべての入力データは以下の条件を満たす．</p>
<ul>
<li><var>3 \leqq N \leqq 100\,000</var>．</li>
<li><var>1 \leqq Ai \leqq 1\,000\,000\,000</var> (<var>1 \leqq i \leqq N</var>)．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題</h3>
<h4>小課題 1 [5 点]</h4>
<p><var>N \leqq 100</var> を満たす．</p>
<h4>小課題 2 [15 点]</h4>
<p><var>N \leqq 400</var> を満たす．</p>
<h4>小課題 3 [30 点]</h4>
<p><var>N \leqq 8\,000</var> を満たす．</p>
<h4>小課題 4 [50 点]</h4>
<p>追加の制限はない．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>6
1
5
4
5
2
4
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>6
</pre>
<p><img alt="図 2: <var>1</var> 番目の切れ込みと <var>3</var> 番目の切れ込みと <var>5</var> 番目の切れ込みで切るのが最善である．" src="https://img.atcoder.jp/joi2014ho/2014-ho-t3-fig02.png" /></p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>30
1
34
44
13
30
1
9
3
7
7
20
12
2
44
6
9
44
31
17
20
33
18
48
23
19
31
24
50
43
15
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>213
</pre></section>
</div>
</span>
</span>
