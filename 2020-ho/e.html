<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3></h3>
<p>JOI 村には <var>N</var> 個の区画があり，<var>1</var> から <var>N</var> までの番号が付いている．これらの区画は番号順に一列に並んでいる．今，各区画では火事が発生しており，時刻 <var>0</var> における区画 <var>i</var> (<var>1 \leqq i \leqq N</var>) の火の強さは <var>S_i</var> (<var>S_i &gt; 0</var>) である．</p>
<p>時刻 <var>0</var> に，区画 <var>1</var> から区画 <var>N</var> の方向に風が吹き始めた．隣り合う <var>2</var> つの区画について，時刻 <var>t</var> (<var>0 \leqq t</var>) において風上の区画の火が風下の区画の火より強いとき，時刻 <var>t + 1</var> における風下の区画の火の強さは，時刻 <var>t</var> における風上の区画の火の強さと同じになってしまう．そうでないときは，時刻 <var>t + 1</var> における風下の区画の火の強さは，時刻 <var>t</var> と同じである．すなわち，時刻 <var>t</var> (<var>0 \leqq t</var>) における区画 <var>i</var> (<var>1 \leqq i \leqq N</var>) の火の強さを <var>S_i(t)</var> と書くとすると，<var>1 \leqq t</var> ならば，<var>S_i(t) = \max\{S_{i − 1}(t − 1), S_i(t − 1)\}</var> となる．ただし，任意の <var>t</var> (<var>0 \leqq t</var>) に対して，<var>S_0(t) = 0</var> とし，任意の <var>i</var> (<var>1 \leqq i \leqq N</var>) に対し <var>S_i(0) = S_i</var> とする．</p>
<p>消防士であるあなたは <var>Q</var> 個の消火活動を計画した．<var>Q</var> 個の計画のうちどれか <var>1</var> つだけを実施する予定である．<var>j</var> 番目の計画 (<var>1 \leqq j \leqq Q</var>) は，時刻 <var>T_j</var> に，<var>L_j \leqq k \leqq R_j</var> となるすべての区画 <var>k</var> に消火剤を撒き，それらの区画を消火するというものである．火の強さが <var>s</var> である区画を消火するためには <var>s</var> リットルの消火剤が必要である．つまり，<var>j</var> 番目の計画の消火活動には <var>S_{L_j}(T_j) + S_{L_j + 1}(T_j) + \cdots + S_{R_j}(T_j)</var> リットルの消火剤が必要である．</p>
<p>どの計画を実行するか吟味するためにも，各計画に必要な消火剤の量が知りたい．</p>
<p>時刻 <var>0</var> における火の強さの情報と消火活動の計画の情報が与えられたとき，各計画に必要な消火剤の量を求めるプログラムを作成せよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は以下の形式で標準入力から与えられる．入力される値はすべて整数である．</p>
<pre><var>N</var> <var>Q</var>
<var>S_1</var> <var>\cdots</var> <var>S_N</var>
<var>T_1</var> <var>L_1</var> <var>R_1</var>
<var>\vdots</var>
<var>T_Q</var> <var>L_Q</var> <var>R_Q</var>
</pre>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>標準出力に <var>Q</var> 行で出力せよ．第 <var>j</var> 行目 (<var>1 \leqq j \leqq Q</var>) には <var>j</var> 番目の計画に必要な消火剤の量を出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>制約</h3>
<ul>
<li><var>1 \leqq N \leqq 200\,000</var>．</li>
<li><var>1 \leqq Q \leqq 200\,000</var>．</li>
<li><var>1 \leqq S_i \leqq 1\,000\,000\,000</var> (<var>1 \leqq i \leqq N</var>)．</li>
<li><var>1 \leqq T_j \leqq N</var> (<var>1 \leqq j \leqq Q</var>)．</li>
<li><var>1 \leqq L_j \leqq R_j \leqq N</var> (<var>1 \leqq j \leqq Q</var>)．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題</h3>
<ol>
<li>(<var>1</var> 点) <var>N \leqq 200</var>，<var>Q \leqq 200</var>．</li>
<li>(<var>6</var> 点) <var>T_1 = T_2 = \cdots = T_Q</var>．</li>
<li>(<var>7</var> 点) <var>L_j = R_j</var> (<var>1 \leqq j \leqq Q</var>)．</li>
<li>(<var>6</var> 点) <var>S_i \leqq 2</var> (<var>1 \leqq i \leqq N</var>)．</li>
<li>(<var>80</var> 点) 追加の制約はない．</li>
</ol>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>5 5
9 3 2 6 5
1 1 3
2 1 5
3 2 5
4 3 3
5 3 5
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>21
39
33
9
27
</pre>
<ul>
<li>時刻 <var>0</var> における各区画の火の強さは，区画 <var>1</var> から順に <var>9, 3, 2, 6, 5</var> である．</li>
<li>時刻 <var>1</var> における各区画の火の強さは，区画 <var>1</var> から順に <var>9, 9, 3, 6, 6</var> である．よって，<var>1</var> 番目の計画に必要な消火剤の量は <var>9 + 9 + 3 = 21</var> リットルである．</li>
<li>時刻 <var>2</var> における各区画の火の強さは，区画 <var>1</var> から順に <var>9, 9, 9, 6, 6</var> である．よって，<var>2</var> 番目の計画に必要な消火剤の量は <var>9 + 9 + 9 + 6 + 6 = 39</var> リットルである．</li>
<li>時刻 <var>3</var> における各区画の火の強さは，区画 <var>1</var> から順に <var>9, 9, 9, 9, 6</var> である．よって，<var>3</var> 番目の計画に必要な消火剤の量は <var>9 + 9 + 9 + 6 = 33</var> リットルである．</li>
<li>時刻 <var>4</var> における各区画の火の強さは，区画 <var>1</var> から順に <var>9, 9, 9, 9, 9</var> である．よって，<var>4</var> 番目の計画に必要な消火剤の量は <var>9</var> リットルである．</li>
<li>時刻 <var>5</var> における各区画の火の強さは，区画 <var>1</var> から順に <var>9, 9, 9, 9, 9</var> である．よって，<var>5</var> 番目の計画に必要な消火剤の量は <var>9 + 9 + 9 = 27</var> リットルである．</li>
</ul>
<p>入力例 <var>1</var> は小課題 <var>1, 5</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>10 10
3 1 4 1 5 9 2 6 5 3
1 1 6
2 8 10
4 2 7
8 3 3
6 1 10
3 2 8
5 1 9
7 4 5
9 7 9
10 10 10
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>28
21
34
4
64
43
55
9
27
9
</pre>
<p>入力例 <var>2</var> は小課題 <var>1, 5</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 3</h3>
<pre>10 10
3 1 4 1 5 9 2 6 5 3
1 6 6
2 8 8
4 2 2
8 3 3
6 1 1
3 4 4
5 5 5
7 10 10
9 8 8
10 7 7
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3>
<pre>9
9
3
4
3
4
5
9
9
9
</pre>
<p>入力例 <var>3</var> は小課題 <var>1, 3, 5</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 4</h3>
<pre>10 10
3 1 4 1 5 9 2 6 5 3
7 1 6
7 8 10
7 2 7
7 3 3
7 1 10
7 2 8
7 1 9
7 4 5
7 7 9
7 10 10
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3>
<pre>28
27
34
4
64
43
55
9
27
9
</pre>
<p>入力例 <var>4</var> は小課題 <var>1, 2, 5</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 5</h3>
<pre>20 20
2 1 2 2 1 1 1 1 2 2 2 1 2 1 1 2 1 2 1 1
1 1 14
2 3 18
4 10 15
8 2 17
9 20 20
4 8 19
7 2 20
11 1 5
13 2 8
20 1 20
2 12 15
7 1 14
12 7 18
14 2 17
9 19 20
12 12 12
6 2 15
11 2 15
19 12 17
4 1 20
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 5</h3>
<pre>25
30
12
32
2
24
38
10
14
40
8
28
24
32
4
2
28
28
12
40
</pre>
<p>入力例 <var>5</var> は小課題 <var>1, 4, 5</var> の制約を満たす．</p></section>
</div>
</span>
</span>
