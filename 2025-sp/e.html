<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3></h3>
<p>JOI 君が住む IOI 国は，大きな湖があることで有名である．今日，湖の周りでスタンプラリー大会が行われることになった．</p>
<p>湖の周りには等間隔に <var>2N</var> 個の地点が並んでおり，時計回りに <var>1</var> から <var>2N</var> までの番号が付けられている．
また，隣り合う地点どうしを結ぶ <var>2N</var> 本の <strong>一方通行</strong> の道がある．
道 <var>i</var> (<var>1\leqq i \leqq 2N-1</var>) は地点 <var>i</var> から地点 <var>i+1</var> へ向かう道であり，道 <var>2N</var> は地点 <var>2N</var> から地点 <var>1</var> へ向かう道である．
それぞれの道の真ん中には <var>1</var> つのスタンプ台が設置されている．</p>
<p>スタンプには <var>1</var> から <var>N</var> までの <var>N</var> 色があり，道 <var>i</var> (<var>1\leqq i \leqq 2N</var>) の真ん中に設置されているスタンプ台で押すことのできるスタンプの色は <var>A_i</var> である．
各 <var>j</var> (<var>1\leqq j \leqq N</var>) について，色 <var>j</var> のスタンプを押すことのできるスタンプ台はちょうど <var>2</var> つある．</p>
<p>JOI 君はたくさんのスタンプカードを持ってスタンプラリー大会に参加することにした．
それぞれのスタンプカードには左右 <var>2</var> 箇所にスタンプを押すことのできる枠が印刷されている．
<var>1</var> つの枠にはスタンプを高々 <var>1</var> つ押すことができる．
はじめ，どのスタンプカードにもスタンプは押されていない．
スタンプラリー大会での JOI 君の行動は以下の通りである．</p>
<ol>
<li>まず，スタート地点として <var>2N</var> 個の地点のいずれかを選び，その地点に移動する．地点 <var>i</var> (<var>1\leqq i \leqq 2N</var>) をスタート地点に選んだとき，JOI 君はスタンプラリー大会の参加費としてコスト <var>C_i</var> を支払う．</li>
<li>次に，JOI 君は隣り合う道どうしに設置されているスタンプ台を交換するよう，運営会社に指示を出すことができる．すなわち，道 <var>2N,1</var> に設置されているスタンプ台の交換，もしくは，<var>i</var> (<var>2\leqq i \leqq 2N</var>) を指定して道 <var>i-1,i</var> に設置されているスタンプ台の交換を指示することができる．
   JOI 君が指示を出す際に支払うコストは <var>1</var> 回あたり <var>X</var> で， <strong>何度でも</strong> 指示を出すことができる．一度も指示を出さないことも可能である．スタンプ台の交換は指示を出すたびにただちに実行される．
   ただし，不正防止のため，JOI 君が選んだスタート地点をまたぐようなスタンプ台の交換はできない．すなわち，JOI 君がスタート地点として地点 <var>1</var> を選んだ場合は道 <var>2N,1</var> に設置されているスタンプ台どうしの交換が，地点 <var>i</var> (<var>2\leqq i \leqq 2N</var>) を選んだ場合は道 <var>i-1,i</var> に設置されているスタンプ台どうしの交換が，禁止される．</li>
<li>その後，JOI 君はスタート地点を出発して時計回りに移動し，<var>2N</var> 個のスタンプ台を順に訪れ，スタート地点に戻ってきた段階でスタンプラリーを終了する．スタンプ台を訪れた際，JOI 君はスタンプカードにスタンプを何回でも押すことができる．同じスタンプ台で <var>1</var> 枚のスタンプカードの左右にスタンプを押すことも可能である．ただし，それぞれのスタンプカードには必ず左，右の順番で押す必要がある．つまり，左側が空欄であるスタンプカードの右側にスタンプを押すことはできない．</li>
</ol>
<p>JOI 君はできる限り多くの種類の，左右両方の枠にスタンプが押されたスタンプカードを集めたい．
左側に色 <var>a</var>，右側に色 <var>b</var> のスタンプが押されたスタンプカードをスタンプカード <var>(a,b)</var> と表すこととする．
このとき，スタンプカード <var>(a_1, b_1)</var> と <var>(a_2, b_2)</var> は，<var>a_1=a_2</var> かつ <var>b_1=b_2</var> のとき，またそのときに限り，種類が同じであるとみなす．</p>
<p><var>N</var> 色のスタンプがあるため，左右両方の枠にスタンプが押されたスタンプカードは全部で <var>N^2</var> 種類あることに注意せよ．</p>
<p>あなたは JOI 君の戦略作りを手伝うために，<var>Q</var> 個の質問に答える必要がある．
<var>q</var> 個目 (<var>1\leqq q \leqq Q</var>) の質問は以下である．</p>
<ul>
<li>スタンプラリーの終了時点で，左右両方の枠にスタンプが押されたスタンプカードを <var>K_q</var> 種類以上持っているために支払う必要のあるコストの合計の最小値はいくらか？なお，本問の制約下では，十分多くのコストを支払うことで左右両方の枠にスタンプが押されたスタンプカードを <var>K_q</var> 種類以上集められることが証明できる．</li>
</ul>
<p>スタンプの色，スタンプラリー大会の参加費，運営会社に指示を出す際に支払うコスト，および JOI 君の質問についての情報が与えられたとき，JOI 君の <var>Q</var> 個の質問の答えを計算するプログラムを作成せよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は以下の形式で標準入力から与えられる．</p>
<pre><var>N</var> <var>X</var>
<var>A_1</var> <var>A_2</var> <var>\cdots</var> <var>A_{2N}</var>
<var>C_1</var> <var>C_2</var> <var>\cdots</var> <var>C_{2N}</var>
<var>Q</var>
<var>K_1</var>
<var>K_2</var>
<var>\vdots</var>
<var>K_Q</var>
</pre>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>標準出力に <var>Q</var> 行で出力せよ．
<var>q</var> 行目 (<var>1\leqq q \leqq Q</var>) には，スタンプラリーの終了時点で，左右両方の枠にスタンプが押されたスタンプカードを <var>K_q</var> 種類以上持っているために，支払う必要のあるコストの合計の最小値を出力せよ．</p>
</section>
</div>
</div>

<div class="part">
<section>
<h3>制約</h3>
<ul>
<li><var>2 \leqq N \leqq 500\,000</var>．</li>
<li><var>1 \leqq X \leqq 500\,000</var>．</li>
<li><var>(A_1, A_2, \dots, A_{2N})</var> は <var>(1, 1, 2, 2, \dots, N, N)</var> の並べ替えである．</li>
<li><var>1 \leqq C_i \leqq 10^{18}</var> (<var>1 \leqq i \leqq 2N</var>)．</li>
<li><var>1 \leqq Q \leqq 500\,000</var>．</li>
<li><var>1 \leqq K_q \leqq N^2</var> (<var>1\leqq q \leqq Q</var>)．</li>
<li>入力される値はすべて整数である．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題</h3>
<ol>
<li>(<var>5</var> 点) <var>N\leqq 4</var>．</li>
<li>(<var>20</var> 点) <var>N\leqq 5000</var>，<var>Q = 1</var>，<var>K_1=N^2</var>．</li>
<li>(<var>20</var> 点) <var>N\leqq 5000</var>，<var>Q = 1</var>．</li>
<li>(<var>19</var> 点) <var>N\leqq 5000</var>．</li>
<li>(<var>21</var> 点) <var>Q = 1</var>．</li>
<li>(<var>15</var> 点) 追加の制約はない．</li>
</ol>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>3 2
1 2 2 3 1 3
6 1 4 5 4 7
2
8
9
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>3
4
</pre>
<p>JOI 君がスタート地点として地点 <var>2</var> を選び，道 <var>3</var> に設置されているスタンプ台と道 <var>4</var> に設置されているスタンプ台との交換を指示した場合を考える．
このとき，</p>
<ul>
<li>JOI 君が支払うコストの合計は <var>C_2+X\times 1 = 3</var> である．</li>
<li>JOI 君は道 <var>2,3,4,5,6,1</var> の順にスタンプ台を訪れ，それぞれのスタンプ台で押すことのできるスタンプの色は，順に色 <var>2, 3, 2, 1, 3, 1</var> となる．</li>
<li>JOI 君が最終的に持っている可能性のある，左右両方の枠にスタンプが押されたスタンプカードは <var>8</var> 種類となる．<ul>
<li>例えば，左側に色 <var>3</var> のスタンプ，右側に色 <var>1</var> のスタンプが押されたスタンプカードを得るためには，道 <var>3</var> でスタンプカードの左側に，道 <var>1</var> でスタンプカードの右側に，それぞれスタンプを押せばよい．</li>
<li>左側に色 <var>1</var> のスタンプ，右側に色 <var>2</var> のスタンプが押されたスタンプカードだけは得られないことに注意せよ．</li>
</ul>
</li>
</ul>
<p><var>2</var> 以下のコストで <var>8</var> 種類以上のスタンプカードを得ることはできないため，<var>1</var> 行目には <var>3</var> を出力する．</p>
<p>また，JOI 君がスタート地点として地点 <var>3</var> を選び，スタンプ台の交換を指示しなかった場合には，<var>9</var> 種類のスタンプカードを得ることができる．
このときに JOI 君が支払うコストの合計は <var>C_3 + X\times 0 = 4</var> である．</p>
<p><var>3</var> 以下のコストで <var>9</var> 種類以上のスタンプカードを得ることはできないため，<var>2</var> 行目には <var>4</var> を出力する．</p>
<p>この入力例は小課題 <var>1,4,6</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>8 1
1 2 6 1 6 3 8 4 5 5 3 4 7 2 7 8
4 5 3 6 2 9 1 4 6 3 8 5 2 9 4 7
1
64
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>7
</pre>
<p>スタート地点として地点 <var>10</var> を選び，次の順にスタンプ台の交換を指示した場合を考える．</p>
<ul>
<li>道 <var>15</var> に設置されているスタンプ台と道 <var>16</var> に設置されているスタンプ台との交換</li>
<li>道 <var>2</var> に設置されているスタンプ台と道 <var>3</var> に設置されているスタンプ台との交換</li>
<li>道 <var>16</var> に設置されているスタンプ台と道 <var>1</var> に設置されているスタンプ台との交換</li>
<li>道 <var>1</var> に設置されているスタンプ台と道 <var>2</var> に設置されているスタンプ台との交換</li>
</ul>
<p>このとき <var>64</var> 種類のスタンプカードを得ることができ，支払うコストの合計は <var>C_{10}+X\times 4=7</var> である．</p>
<p>この入力例は小課題 <var>2,3,4,5,6</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 3</h3>
<pre>9 4
4 3 5 3 8 1 5 8 1 7 6 2 4 9 6 9 2 7
12 9 4 8 7 1 20 5 8 7 4 13 5 9 10 3 7 8
6
39
81
73
79
64
52
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3>
<pre>1
18
3
10
1
1
</pre>
<p>この入力例は小課題 <var>4,6</var> の制約を満たす．</p></section>
</div>
</span>
</span>
