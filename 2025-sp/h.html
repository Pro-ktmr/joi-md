<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3></h3>
<p>K 理事長は <var>N</var> 日間の会議を運営する予定である．
<var>1</var> 日に会議は <var>1</var> つ開催され，メインの会場 A とサブの会場 B, C のいずれか <var>1</var> つが使用される．</p>
<p>各会議の会場に関する情報は <code>A</code>, <code>B</code>, <code>C</code>, <code>?</code> からなる文字列 <var>S</var> で与えられる．
<var>i</var> 日目 (<var>1\leqq i \leqq N</var>) の会議の会場は，<var>S</var> の <var>i</var> 文字目が <code>A</code> の場合は会場 A，<code>B</code> の場合は会場 B，<code>C</code> の場合は会場 C，<code>?</code> の場合は未定である．ただし， <var>1</var> 日目と <var>N</var> 日目の会議は多くの人が参加するため，会場 A が使われることが決まっている．</p>
<p>これから K 理事長は，会場が未定の会議について，それぞれ会場 A, B, C のいずれか <var>1</var> つを割り当てようとしている．
また，移動の負担を減らすために，<var>j</var> 日目と <var>j+1</var> 日目で会議の会場が異なるような <var>j</var> (<var>1\leqq j \leqq N-1</var>) の個数を最小にしたいと考えている．</p>
<p>会場が未定の会議の割り当てについて，<var>Q</var> 個のシナリオを検討し，上記の個数の最小化を考えたい．
<var>k</var> 番目 (<var>1 \leqq k \leqq Q</var>) のシナリオとそれに対応する質問は以下の通りである．</p>
<ul>
<li>会場が未定の会議について，<var>X_k</var> 個に会場 A を，<var>Y_k</var> 個に会場 B を，<var>Z_k</var> 個に会場 C を割り当てることにする．この時，<var>j</var> 日目と <var>j+1</var> 日目で会議の会場が異なるような <var>j</var> の個数の最小値を求めよ．</li>
</ul>
<p>会場の情報，また検討すべきシナリオの情報が与えられたとき，質問に回答するプログラムを作成せよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は以下の形式で標準入力から与えられる．</p>
<pre><var>N</var>
<var>S</var>
<var>Q</var>
<var>X_1</var> <var>Y_1</var> <var>Z_1</var>
<var>X_2</var> <var>Y_2</var> <var>Z_2</var>
<var>\vdots</var>
<var>X_Q</var> <var>Y_Q</var> <var>Z_Q</var>
</pre>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>標準出力に <var>Q</var> 行出力せよ．<var>k</var> 行目 (<var>1 \leqq k \leqq Q</var>) には，会場が未定の会議について， <var>X_k</var> 個に会場 A を， <var>Y_k</var> 個に会場 B を， <var>Z_k</var> 個に会場 C を割り当てることにした場合の <var>j</var> 日目と <var>j+1</var> 日目で会議の会場が異なるような <var>j</var> の個数の最小値を出力せよ．</p>
</section>
</div>
</div>

<div class="part">
<section>
<h3>制約</h3>
<ul>
<li><var>2 \leqq N \leqq 300\,000</var>．</li>
<li><var>S</var> は <code>A</code>, <code>B</code>, <code>C</code>, <code>?</code> からなる長さ <var>N</var> の文字列である．</li>
<li><var>S</var> の <var>1</var> 文字目と <var>N</var> 文字目 は <code>A</code> である．</li>
<li><var>1 \leqq Q \leqq 200\,000</var>．</li>
<li><var>0 \leqq X_k</var> (<var>1\leqq k \leqq Q</var>)．</li>
<li><var>0 \leqq Y_k</var> (<var>1\leqq k \leqq Q</var>)．</li>
<li><var>0 \leqq Z_k</var> (<var>1\leqq k \leqq Q</var>)．</li>
<li><var>X_k + Y_k + Z_k</var> は <var>S</var> に含まれる <code>?</code> の個数と等しい (<var>1\leqq k \leqq Q</var>)．</li>
<li><var>N, Q, X_k, Y_k, Z_k</var>は整数である (<var>1\leqq k \leqq Q</var>)．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題</h3>
<ol>
<li>(<var>4</var> 点) <var>N \leqq 50</var>，<var>S</var> に含まれる <code>?</code> の個数は <var>13</var> 以下．</li>
<li>(<var>7</var> 点) <var>N \leqq 500</var>．</li>
<li>(<var>13</var> 点) <var>N \leqq 5\,000</var>，<var>Q \leqq 10</var>．</li>
<li>(<var>18</var> 点) <var>N \leqq 5\,000</var>．</li>
<li>(<var>12</var> 点) <var>Q \leqq 10</var>．</li>
<li>(<var>8</var> 点) <var>S</var> に <code>C</code> は含まれない，<var>Z_k = 0</var> (<var>1\leqq k \leqq Q</var>)．</li>
<li>(<var>13</var> 点) <var>Z_k = 0</var> (<var>1\leqq k \leqq Q</var>)．</li>
<li>(<var>25</var> 点) 追加の制約はない．</li>
</ol>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>9
A??B??C?A
3
1 3 1
4 1 0
0 0 5
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>3
4
4
</pre>
<p><var>1</var> 番目のシナリオでは，会場が未定の会議 <var>5</var> 個のうち， <var>1</var> 個に会場 A を， <var>3</var> 個に会場 B を， <var>1</var> 個に会場 C を割り当てる．
例えば，各会議の会場に関する情報が <code>ABBBBCCAA</code> となるような割り当て方が考えられる．この場合， <var>j</var> 日目と <var>j+1</var> 日目で会議の会場が異なるような <var>j</var> は <var>1,5,7</var> の <var>3</var> 個となる．
<var>j</var> の個数を <var>2</var> 個以下にするような方法は存在しないため， <var>1</var> 行目には <var>3</var> を出力する．</p>
<p><var>2</var> 番目のシナリオでは，会場が未定の会議 <var>5</var> 個のうち， <var>4</var> 個に会場 A を， <var>1</var> 個に会場 B を割り当てる．
例えば，各会議の会場に関する情報が <code>AAABBACAA</code> となるような割り当て方が考えられる．この場合，<var>j</var> 日目と <var>j+1</var> 日目で会議の会場が異なるような <var>j</var> は <var>3,5,6,7</var> の <var>4</var> 個となる．
<var>j</var> の個数を <var>3</var> 個以下にするような方法は存在しないため， <var>2</var> 行目には <var>4</var> を出力する．</p>
<p><var>3</var> 番目のシナリオでは，会場が未定の会議 <var>5</var> 個のうち， すべてに会場 C を割り当てる．
<var>j</var> 日目と <var>j+1</var> 日目で会議の会場が異なるような <var>j</var> は <var>1,3,4,8</var> の <var>4</var> 個となり， <var>3</var> 行目には <var>4</var> を出力する．</p>
<p>この入力例は小課題 <var>1,2,3,4,5,8</var> の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>12
A???A?B????A
4
0 8 0
2 6 0
7 1 0
3 5 0
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>4
4
2
2
</pre>
<p>この入力例はすべての小課題の制約を満たす．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 3</h3>
<pre>28
ACB??B???BCB??B????B?AAA?BBA
26
6 1 6
4 5 4
2 3 8
9 2 2
11 0 2
8 4 1
11 0 2
2 0 11
0 1 12
12 1 0
10 3 0
1 4 8
3 7 3
2 8 3
1 3 9
11 1 1
7 0 6
6 4 3
8 4 1
0 10 3
13 0 0
11 1 1
0 6 7
2 8 3
9 0 4
0 0 13
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3>
<pre>15
11
13
13
15
12
15
15
16
15
13
12
10
9
13
15
15
11
12
9
15
15
11
9
15
17
</pre>
<p>この入力例は小課題 <var>1,2,4,8</var> の制約を満たす．</p></section>
</div>
</span>
</span>
