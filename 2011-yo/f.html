<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題</h3>
<p>情報オリンピック日本委員会では，今年の日本情報オリンピック (JOI) を宣伝するために，JOI のロゴをモチーフにした旗を作ることになった．旗は「良い旗」でなければならない．「良い旗」とは，アルファベットの J，O，I のいずれかの文字を，縦 <var>M</var> 行，横 <var>N</var> 列の長方形状に並べたもので，J，O，I が以下の図のように (すなわち，J の右隣に O が，その J の下隣に I が) 並んでいる箇所が旗の少なくとも <var>1</var> か所にあるものである．</p>
<p><img alt="" src="https://img.atcoder.jp/joi2011yo/2011-yo-t6-fig01.png" /></p>
<p>以下の図に，「良い旗」の例を <var>2</var> つ示す．</p>
<p><img alt="" src="https://img.atcoder.jp/joi2011yo/2011-yo-t6-fig02.png" /></p>
<p>以下の図に，「良い旗」ではない例を <var>2</var> つ示す．</p>
<p><img alt="" src="https://img.atcoder.jp/joi2011yo/2011-yo-t6-fig03.png" /></p>
<p>いま <var>M, N</var> の値，および旗の一部の場所について J，O，I のどの文字にするかが決まっており，入力としてその情報が与えられる．考えられる「良い旗」は何通りあるかを計算し，その数を <var>100\,000 \ (= 10^5)</var> で割った余りを出力するプログラムを作成せよ．</p>
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は <var>1 + M</var> 行からなる．</p>
<p><var>1</var> 行目には旗の大きさを表す <var>2</var> つの整数 <var>M, N</var> (<var>2 \leqq M \leqq 20</var>，<var>2 \leqq N \leqq 20</var>) が空白で区切られて書かれている．</p>
<p><var>1 + i</var> 行目 (<var>1 \leqq i \leqq M</var>) には，<var>N</var> 文字からなる文字列が書かれている．各文字は J，O，I，? のいずれかであり，<var>j</var> 文字目 (<var>1 \leqq j \leqq N</var>) が J，O，I のいずれかである場合は <var>i</var> 行 <var>j</var> 列の場所の文字がそれぞれ J，O，I に決まっていること，? である場合はまだ決まっていないことを表す．</p>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>考えられる「良い旗」の個数を <var>100\,000 \ (= 10^5)</var> で割った余りを <var>1</var> 行で出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>2 3
??O
IIJ
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>4
</pre>
<p>入力例 <var>1</var> においては，以下の図の <var>4</var> 通りの「良い旗」が考えられる．</p>
<p><img alt="" src="https://img.atcoder.jp/joi2011yo/2011-yo-t6-fig04.png" /></p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>2 2
??
??
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>3
</pre>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 3</h3>
<pre>3 3
??I
???
O?J
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3>
<pre>53
</pre>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 4</h3>
<pre>5 4
JOI?
????
????
????
?JOI
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3>
<pre>28218
</pre>
<p>入力例 <var>4</var> においては，「良い旗」は <var>2\,428\,218</var> 通り考えられるので，それを <var>100\,000 \ (= 10^5)</var> で割った余りである <var>28\,218</var> を出力する．</p></section>
</div>
</span>
</span>
