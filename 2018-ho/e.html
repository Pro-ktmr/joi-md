<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3></h3>
<p>JOI 研究所では <var>2^L</var> 匹の毒蛇を飼っており，それぞれ <var>0, 1, \ldots, 2^L - 1</var> の番号が付けられている．すべての毒蛇は頭から順に <var>L</var> 個の部分に分かれており，それぞれの部分は青または赤である．毒蛇 <var>i</var> に対し，<var>i</var> を <var>2</var> 進表記して <var>i = \sum_{k = 1}^{L} c_k 2^{L - k}</var> (<var>0 \leqq c_k \leqq 1</var>) とおいたとき，</p>
<ul>
<li><var>c_k = 0</var> であれば，毒蛇 <var>i</var> の頭から数えて <var>k</var> 番目の部分は青であり，</li>
<li><var>c_k = 1</var> であれば，毒蛇 <var>i</var> の頭から数えて <var>k</var> 番目の部分は赤である．</li>
</ul>
<p>各毒蛇には毒性と呼ばれる <var>0</var> 以上 <var>9</var> 以下の整数値が定まっている．<code>0</code>，<code>1</code>，<code>2</code>，<code>3</code>，<code>4</code>，<code>5</code>，<code>6</code>，<code>7</code>，<code>8</code>，<code>9</code> からなる長さ <var>2^L</var> の文字列 <var>S</var> が与えられ，その <var>i</var> 文字目 (<var>1 \leqq i \leqq 2^L</var>) は毒蛇 <var>i - 1</var> の毒性を表す．</p>
<p>毒蛇たちの動きは素早いので，JOI 研究所からは，よく毒蛇たちが脱走してしまう．JOI 研究所には脱走した毒蛇を目撃した周辺住民から苦情が寄せられる．</p>
<p>あなたには，<var>Q</var> 日間にわたる苦情の情報が与えられる．<var>d</var> 日目 (<var>1 \leqq d \leqq Q</var>) に寄せられた苦情は <code>0</code>，<code>1</code>，<code>?</code> からなる長さ <var>L</var> の文字列 <var>T_d</var> として表され，</p>
<ul>
<li><var>T_d</var> の <var>j</var> 文字目 (<var>1 \leqq j \leqq L</var>) が <code>0</code> の場合は，<var>d</var> 日目に脱走したすべての毒蛇の頭から数えて <var>j</var> 番目の部分が青であることを表し，</li>
<li><var>T_d</var> の <var>j</var> 文字目 (<var>1 \leqq j \leqq L</var>) が <code>1</code> の場合は，<var>d</var> 日目に脱走したすべての毒蛇の頭から数えて <var>j</var> 番目の部分が赤であることを表し，</li>
<li><var>T_d</var> の <var>j</var> 文字目 (<var>1 \leqq j \leqq L</var>) が <code>?</code> の場合は，<var>d</var> 日目に脱走した毒蛇の頭から数えて <var>j</var> 番目の部分については，周辺住民からは情報が与えられなかったことを表す．</li>
</ul>
<p>苦情はすべて正確な情報である．脱走した毒蛇は JOI 研究所の職員がその日のうちに捕獲する．捕獲された毒蛇が，翌日以降に再び脱走することはあり得る．</p>
<p>毒蛇の脱走によるリスクを見積もるために，JOI 研究所の K 理事長は脱走した可能性のある毒蛇の毒性の合計を知りたい．あなたの仕事は，<var>Q</var> 日間にわたる苦情の情報から，それぞれの日ごとに，その日に脱走した可能性のある毒蛇の毒性の合計を求めるプログラムを作成することである．</p>
</section>
</div>

<div class="part">
<section>
<h3>課題</h3>
<p>毒蛇の毒性を表す文字列 <var>S</var> と，<var>Q</var> 日間の苦情の情報が与えられるので，それぞれの日ごとに，その日に脱走した可能性のある毒蛇の毒性の合計を求めるプログラムを作成せよ．</p>
<p>メモリ制限が小さいことに注意すること．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>標準入力から以下の入力を読み込め．</p>
<ul>
<li><var>1</var> 行目には，整数 <var>L, Q</var> が空白を区切りとして書かれている．これらは順に，毒蛇の部分の個数と，苦情の寄せられる日数を表す．</li>
<li><var>2</var> 行目には，長さ <var>2^L</var> の文字列 <var>S</var> が書かれている．この文字列は毒蛇の毒性を表す．</li>
<li>続く <var>Q</var> 行のうちの <var>d</var> 行目 (<var>1 \leqq d \leqq Q</var>) には，長さ <var>L</var> の文字列 <var>T_d</var> が書かれている．この文字列は <var>d</var> 日目の苦情を表す．</li>
</ul>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>標準出力に <var>Q</var> 行で出力せよ．<var>d</var> 行目には，<var>d</var> 日目に脱走した可能性のある毒蛇の毒性の合計を表す整数を出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>制限</h3>
<p>すべての入力データは以下の条件を満たす．</p>
<ul>
<li><var>1 \leqq L \leqq 20</var>．</li>
<li><var>1 \leqq Q \leqq 1\,000\,000</var>．</li>
<li><var>S</var> は長さ <var>2^L</var> の文字列である．</li>
<li>文字列 <var>S</var> は <code>0</code>，<code>1</code>，<code>2</code>，<code>3</code>，<code>4</code>，<code>5</code>，<code>6</code>，<code>7</code>，<code>8</code>，<code>9</code> からなる．</li>
<li><var>T_d</var> は長さ <var>L</var> の文字列である (<var>1 \leqq d \leqq Q</var>)．</li>
<li>文字列 <var>T_d</var> は <code>0</code>，<code>1</code>，<code>?</code> からなる (<var>1 \leqq d \leqq Q</var>)．</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>小課題</h3>
<h4>小課題 1 [5 点]</h4>
<p>以下の条件を満たす．</p>
<ul>
<li><var>L \leqq 10</var>．</li>
<li><var>Q \leqq 1 000</var>．</li>
</ul>
<h4>小課題 2 [7 点]</h4>
<ul>
<li><var>L \leqq 10</var> を満たす．</li>
</ul>
<h4>小課題 3 [10 点]</h4>
<ul>
<li><var>L \leqq 13</var> を満たす．</li>
</ul>
<h4>小課題 4 [53 点]</h4>
<ul>
<li><var>Q \leqq 50 000</var> を満たす．</li>
</ul>
<h4>小課題 5 [25 点]</h4>
<ul>
<li>追加の制限はない．</li>
</ul>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>3 5
12345678
000
0??
1?0
?11
???
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>1
10
12
12
36
</pre>
<p>この入力例では，<var>L = 3</var> である．<var>3</var> つの部分に分かれた毒蛇が，全部で <var>2^3 = 8</var> 匹いる．苦情は <var>5</var> 日間にわたって寄せられる．</p>
<ul>
<li><var>1</var> 日目に脱走した可能性のある毒蛇は，毒蛇 <var>0</var> のみである．毒性の合計は <var>1</var> である．</li>
<li><var>2</var> 日目に脱走した可能性のある毒蛇は，毒蛇 <var>0, 1, 2, 3</var> である．毒性の合計は <var>10</var> である．</li>
<li><var>3</var> 日目に脱走した可能性のある毒蛇は，毒蛇 <var>4, 6</var> である．毒性の合計は <var>12</var> である．</li>
<li><var>4</var> 日目に脱走した可能性のある毒蛇は，毒蛇 <var>3, 7</var> である．毒性の合計は <var>12</var> である．</li>
<li><var>5</var> 日目に脱走した可能性のある毒蛇は，毒蛇 <var>0, 1, 2, 3, 4, 5, 6, 7</var> である．毒性の合計は <var>36</var> である．</li>
</ul>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>4 8
3141592653589793
0101
?01?
??1?
?0??
1?00
01?1
??10
????
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>9
18
38
30
14
15
20
80
</pre></section>
</div>
</span>
</span>
