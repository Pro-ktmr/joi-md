<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題</h3>
<p>ヘビの JOI 君は，ある大きな屋敷に迷い込んでしまった．屋敷の住人に見つかる前に，屋敷を脱出しなければならない．</p>
<p>この屋敷には部屋が <var>N</var> 個あり，<var>1, 2, \ldots, N</var> の番号が付けられている．また，廊下が <var>M</var> 本あり，<var>i</var> 本目の廊下 (<var>1 \leqq i \leqq M</var>) は部屋 <var>A_i</var> と部屋 <var>B_i</var> を結んでいる．JOI 君はこれらの廊下をどちらの向きにも通ることができ，廊下 <var>i</var> を通るのには <var>D_i</var> 分かかる．部屋と部屋の間を廊下を通る以外の手段で移動する方法はない．</p>
<p>この屋敷の部屋の温度はそれぞれ一定に調節されており，JOI 君にとって寒すぎるか，快適であるか，暑すぎるかである．JOI 君は，急な温度変化に対応できないため，最後に寒すぎる部屋を出てから <var>X</var> 分未満のうちに暑すぎる部屋に入ることはできない．同様に，最後に暑すぎる部屋を出てから <var>X</var> 分未満のうちに寒すぎる部屋に入ることもできない．</p>
<p>JOI 君は，移動中に部屋に入るとすぐに部屋から出なければならない．また，廊下の途中で引き返したり，廊下 <var>i</var> を <var>D_i</var> 分より長い時間かけて通ることもできない．ただし，一度訪れた部屋にもう一度入ることや，一度使った廊下をもう一度使うことは許される．</p>
<p>JOI 君は現在部屋 <var>1</var> にいる．この部屋は JOI 君にとって寒すぎる．JOI 君は屋敷の出口のある部屋 <var>N</var> に入ると，屋敷から脱出できる．</p>
<p>JOI 君が屋敷から脱出するのにかかる最短の時間を求めよ．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は <var>1 + N + M</var> 行からなる．</p>
<p><var>1</var> 行目には，<var>3</var> 個の整数 <var>N, M, X</var> (<var>2 \leqq N \leqq 10\,000</var>，<var>1 \leqq M \leqq 20\,000</var>，<var>1 \leqq X \leqq 200</var>) が空白を区切りとして書かれている．これは，屋敷に <var>N</var> 個の部屋と <var>M</var> 本の廊下があり，JOI 君が温度変化に対応するのに <var>X</var> 分かかることを表す．</p>
<p>続く <var>N</var> 行のうちの <var>i</var> 行目 (<var>1 \leqq i \leqq N</var>) には，部屋 <var>i</var> の温度を表す整数 <var>T_i</var> (<var>0 \leqq T_i \leqq 2</var>) が書かれている．JOI 君にとって部屋 <var>i</var> は，<var>T_i = 0</var> のとき寒すぎ，<var>T_i = 1</var> のとき快適であり，<var>T_i = 2</var> のとき暑すぎる．<var>T_1 = 0</var> であることが保証されている．</p>
<p>続く <var>M</var> 行のうちの <var>j</var> 行目 (<var>1 \leqq j \leqq M</var>) には，<var>3</var> 個の整数 <var>A_j, B_j, D_j</var> (<var>1 \leqq A_j &lt; B_j \leqq N</var>，<var>1 \leqq D_j \leqq 200</var>) が空白を区切りとして書かれている．これは，廊下 <var>j</var> が部屋 <var>A_j</var> と部屋 <var>B_j</var> を結んでおり，通るのに <var>D_j</var> 分かかることを表す．同じ部屋の組を結ぶ廊下が複数ある可能性があることに注意せよ．</p>
<p>与えられる入力データでは，JOI 君が屋敷から脱出できることは保証されている．</p>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>JOI 君が屋敷から脱出するのに最短で何分かかるかを表す整数を <var>1</var> 行で出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>8 10 4
0
1
1
2
1
1
2
0
1 2 1
1 3 1
2 3 3
2 4 5
3 4 1
4 5 1
5 6 1
5 8 1
1 7 2
7 8 2
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>9
</pre>
<p>入力例 <var>1</var> では，部屋を <var>1 \rightarrow 2 \rightarrow 3 \rightarrow 4 \rightarrow 5 \rightarrow 6 \rightarrow 5 \rightarrow 8</var> の順に移動するのが最短となる．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>15 25 4
0
1
1
0
2
1
0
1
1
2
0
0
1
0
1
8 11 1
7 10 1
12 14 1
3 8 1
1 5 1
3 9 1
3 8 1
1 5 1
6 15 1
11 12 1
2 14 1
7 10 1
11 12 1
5 13 1
2 8 1
1 4 1
2 11 1
5 6 1
1 13 1
6 12 1
5 10 1
9 13 1
4 10 1
3 12 1
7 13 1
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>6
</pre>
<p>入力例 <var>2</var> では，いくつかの部屋の組 (たとえば部屋 <var>1</var> と部屋 <var>5</var>) を結ぶ廊下が複数ある．</p></section>
</div>
</span>
</span>
