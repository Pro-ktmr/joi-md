<span class="lang">
<span class="lang-ja">
<p>配点： <var>100</var> 点</p>

<div class="part">
<section>
<h3>問題</h3>
<p>IOI 高校のプログラミング部には，J 君と O 君と I 君の <var>3</var> 人の部員がいる．プログラミング部では，部活のスケジュールを組もうとしている．</p>
<p>今，<var>N</var> 日間の活動のスケジュールを決めようとしている．各活動日のスケジュールとして考えられるものは，各部員については活動に参加するかどうかの <var>2</var> 通りがあり，部としては全部で <var>8</var> 通りある．部室の鍵はただ <var>1</var> つだけであり，最初は J 君が持っている．各活動日には，その日の活動に参加する部員のうちのいずれか <var>1</var> 人が鍵を持っている必要があり，活動後に参加した部員のいずれかが鍵を持って帰る．</p>
<p>プログラミング部では，活動日には毎回必ず活動が行われるように，あらかじめ各活動日の責任者を定めた．責任者は，必ずその日の活動に出席しなければならない．</p>
<p>スケジュールを決めようとしている日数と，各活動日の責任者が誰であるかの情報が与えられた時，すべての活動日に部活動を行うことができるようなスケジュール表として考えられるものの数を <var>10\,007</var> で割った余りを求めるプログラムを作成せよ．ただし，部活の終了時に鍵を持って帰る部員は，その日の活動に参加している部員の誰でもよく，最終日は誰が鍵を持って帰ってもよいものとする．</p>
<hr />
</section>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3>
<p>入力は，<var>2</var> 行からなる．</p>
<p><var>1</var> 行目には，スケジュールを決めようとしている日数を表す <var>1</var> つの整数 <var>N</var> (<var>2 \leqq N \leqq 1000</var>) が書かれている．</p>
<p><var>2</var> 行目には，各活動日の責任者を表す <var>N</var> 文字からなる文字列が書かれている．この文字列の <var>i</var> 文字目 (<var>1 \leqq i \leqq N</var>) は，<var>i</var> 日目の活動日の責任者を表す．すなわち，<var>i</var> 文字目が <code>J</code>，<code>O</code>，<code>I</code> であることはそれぞれ <var>i</var> 日目の活動日の責任者が J 君，O 君，I 君であることを意味する．</p>
</section>
</div>
</div>

<div class="io-style">
<div class="part">
<section>
<h3>出力</h3>
<p>スケジュール表として考えられるものの数を <var>10\,007</var> で割った余りを <var>1</var> 行で出力せよ．</p>
<hr />
</section>
</div>
</div>

<div class="part">
<section>
<h3>入力例 1</h3>
<pre>2
OI
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3>
<pre>7
</pre>
<p>入出力例 <var>1</var> において， <var>2</var> 日間の活動日のスケジュールを考える．<var>1</var> 日目の責任者は O 君， <var>2</var> 日目の責任者は I 君である．問題文の条件をみたすスケジュール表は <var>7</var> 通り考えられる．</p>
<p><img alt="" src="https://img.atcoder.jp/joi2014yo/2014-yo-t4-fig01.png" /></p>
<p>この表では，J，O，I はそれぞれその日に J 君，O 君，I 君が参加することを表す．<var>1</var> 日目の責任者は O 君であるが，最初鍵を持っているのは J 君であるため，<var>1</var> 日目の活動には J 君，O 君の両方が参加する必要があることに注意せよ．また，<var>1</var> 日目に鍵を持って帰った人は <var>2</var> 日目にも参加しないといけないので，<var>1</var> 日目と <var>2</var> 日目の両方に参加する人が少なくとも <var>1</var> 人存在しなければならないことに注意せよ．</p>
<hr />
</section>
</div>

<div class="part">
<section>
<h3>入力例 2</h3>
<pre>20
JIOIJOIJOJOIIIOJIOII
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3>
<pre>4976
</pre>
<p>入出力例 <var>2</var> において，条件をみたすスケジュール表は全部で <var>72\,493\,594\,992</var> 通り考えられる．それを <var>10\,007</var> で割った余りである <var>4\,976</var> を出力する．</p></section>
</div>
</span>
</span>
